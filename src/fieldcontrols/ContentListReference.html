<template>
    <require from='./ContentListReference.css'></require>
    <div class="content-list-reference-wrapper ${isFocused ? 'focused' : ''}" click.delegate="focusIn()">
        <div>
            <label>${settings.DisplayName}</label>
        </div>
        <div class="chips-container">
            <md-chip repeat.for="item of Items" md-close.bind='!readOnly' close.trigger="removeReference(item)">
                <icon class="left" content.bind='item'></icon>
                <span style='margin: 0 5px;'>${item.DisplayName || item.Name}</span>
            </md-chip>
            <div class="add-new-container">
                    <div focusout.delegate="focusOut() & debounce:150" focusin.delegate="focusIn()">
                        <input type="text" ref="searchInput" value.bind="searchString & debounce:500 & validate:rules" if.bind="!readOnly" keyup.trigger="handleSearchKeyUp($event)" />
                        <!--<md-input view-model.ref="searchRef" md-label.bind="settings.DisplayName" md-value.bind="searchString & debounce:500 & validate:rules"
                        md-disabled.bind="readOnly" aria-autocomplete="none">
                    </md-input> -->
                    </div>
                    <ul class="autocomplete-content dropdown-content" if.bind="isOpened">
                        <li if.bind="!availableValues || availableValues.length === 0">
                            (There are no items available to select)
                        </li>
                        <li if.bind="availableValues && availableValues.length > 0" repeat.for="value of availableValues" click.delegate="pickValue(value)" class="${$index === selectionIndex ? 'selected' : ''}">
                            <icon content.bind="value"></icon>
                            <div class="text-content">
                                <strong>${value.DisplayName || value.Name}</strong> <br/>
                                <span if.bind='value.Description && value.Description.length'>${value.Description}</span>
                            </div>
                        </li>
                    </ul>
                </div>
        </div>
    </div>
</template>